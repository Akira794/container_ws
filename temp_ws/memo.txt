ラズパイ4Bへ

tar zxvf rtkernel_pack.tgz
cd rtkernel_pack

▼カーネルの置き換え
rm -rf /lib/firmware/brcm /lib/modules /boot/firmware/overlays 

sudo cp -r lib/firmware/brcm /lib/firmware/brcm
sudo cp -r lib/modules /lib/modules
sudo cp  boot/kernel8.img /boot/kernel8.img
sudo cp  boot/kernel8.img /boot/firmware/kernel8.img

sudo cp boot/*.dtb /boot/
sudo cp -r boot/overlays /boot/

//config.txtを /boot/配下に新規作成
cd /boot
sudo vim config.txt

以下を記載
kernel=kernel8.img


 $ sudo vim /boot/firmware/cmdline.txt
 # 末尾に以下を追加
 #  dwc_otg.fiq_fsm_enable=0 dwc_otg.fiq_enable=0 dwc_otg.nak_holdoff=0 dwg_otg.speed=1 rcu_nocbs=0 nohz_full=1-3 isolcpus=1-3

 /boot/firmware/cmdline.txt を /boot直下にコピー


また、以下ファイルを修正
initrd.img から initrd-backup.img を作成
sudo cp /boot/initrd.img /boot/initrd-backup.img

boot/firmware 直下も書き換える
initrd.img から initrd-backup.img を作成
sudo cp /boot/firmware/initrd.img /boot/firmware/initrd-backup.img

boot/firmware 内のconfig.txtを書き換える
sudo vim /boot/firmware/config.txt

前: kernel=initrd.img
後: kernel=kernel8.img

//=====sudo reboot =================
uname -a でカーネル名と PREEMPT_RTになっていることを確認する


https://matoken.org/blog/2016/02/05/call-the-procconfig-gz-in-configs-module/
configs moduleで/proc/config.gzを呼び出す

sudo modprobe configs
$ lsmod|grep configs
zcat /proc/config.gz > .config

以下を実行
sudo apt update && sudo apt -y upgrade
sudo apt purge needrestart

